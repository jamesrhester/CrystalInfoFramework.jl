<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · CrystalInfoFramework documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">CrystalInfoFramework documentation</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">CrystalInfoFramework.jl</a></li><li><a class="tocitem" href="../api/">API Documentation</a></li><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Reading-a-CIF-file"><span>Reading a CIF file</span></a></li><li><a class="tocitem" href="#Updating-a-CIF-file"><span>Updating a CIF file</span></a></li><li><a class="tocitem" href="#Writing-CIFs"><span>Writing CIFs</span></a></li><li><a class="tocitem" href="#Dictionaries-and-DataSources"><span>Dictionaries and DataSources</span></a></li><li><a class="tocitem" href="#DataSources"><span>DataSources</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jamesrhester/CrystalInfoFramework.jl/blob/master/docs/src/tutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Guide"><a class="docs-heading-anchor" href="#Guide">Guide</a><a id="Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Guide" title="Permalink"></a></h1><p>The CIF files used in these examples are provided in the <code>docs</code> directory.</p><h2 id="Reading-a-CIF-file"><a class="docs-heading-anchor" href="#Reading-a-CIF-file">Reading a CIF file</a><a id="Reading-a-CIF-file-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-a-CIF-file" title="Permalink"></a></h2><p>To open a CIF file, and read <code>_cell.length_a</code> from block <code>only_block</code>,  returning a one-element <code>Array{String,1}</code>:</p><pre><code class="language-julia">
using CrystalInfoFramework

nc = Cif(&quot;demo.cif&quot;)
my_block = nc[&quot;saly2_all_aniso&quot;]  #could also use first(nc).second
my_block[&quot;_cell.length_a&quot;]

# output

1-element Array{Union{Missing, Nothing, Dict{String,T}, Array{T,1}, String} where T,1}:
 &quot;11.520(12)&quot;</code></pre><p><code>get_loop</code> returns a <code>DataFrame</code> object that can be manipulated using the  methods of that package, most obviously, <code>eachrow</code> to iterate over the packets in a loop:</p><pre><code class="language-julia">
l = get_loop(my_block,&quot;_atom_site.label&quot;);

for r in eachrow(l)
    println(&quot;$(r[Symbol(&quot;_atom_site.fract_x&quot;)])&quot;)
end

# output

.5505(5)
.4009(5)
.2501(5)
.4170(7)
.3145(7)
.2789(8)
.3417(9)
.4445(9)
.4797(8)
.4549(7)</code></pre><h2 id="Updating-a-CIF-file"><a class="docs-heading-anchor" href="#Updating-a-CIF-file">Updating a CIF file</a><a id="Updating-a-CIF-file-1"></a><a class="docs-heading-anchor-permalink" href="#Updating-a-CIF-file" title="Permalink"></a></h2><p>Single key-value pairs are added in the same way as for a normal dictionary. </p><pre><code class="language-julia">my_block[&quot;_new_item&quot;] = &quot;a fine item&quot;
my_block[&quot;_number_item&quot;] = 23</code></pre><p>If the dataname belongs to a loop, a two-step process is required to add the values. First the column of values for the new data name is added as above, and then the new dataname can be added to a previously-existing  loop. The following call adds <code>_new_loop_item</code> to the loop containing  <code>_old_item</code>:</p><pre><code class="language-julia">my_block[&quot;_new_loop_item&quot;] = [1,2,3,4]
add_to_loop(my_block,&quot;_old_item&quot;,&quot;_new_loop_item&quot;)</code></pre><p>The number of values in the array assigned to <code>_new_loop_item</code> must match the length of the loop it is added to - this is checked.</p><h2 id="Writing-CIFs"><a class="docs-heading-anchor" href="#Writing-CIFs">Writing CIFs</a><a id="Writing-CIFs-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-CIFs" title="Permalink"></a></h2><p>To write a syntactically-correct CIF, open an IO stream and write the contents of the <code>Cif</code> object as MIME type &quot;text/cif&quot;:</p><pre><code class="language-julia">t = open(&quot;newcif.cif&quot;,&quot;w&quot;)
show(t,MIME(&quot;text/cif&quot;),mycif)
close(t)</code></pre><h2 id="Dictionaries-and-DataSources"><a class="docs-heading-anchor" href="#Dictionaries-and-DataSources">Dictionaries and DataSources</a><a id="Dictionaries-and-DataSources-1"></a><a class="docs-heading-anchor-permalink" href="#Dictionaries-and-DataSources" title="Permalink"></a></h2><p>CIF dictionaries are created by passing the dictionary file name to <code>DDLm_Dictionary</code> or <code>DDL2_Dictionary</code> constructors.</p><pre><code class="language-julia">d = DDLm_Dictionary(&quot;cif_core.dic&quot;)</code></pre><h2 id="DataSources"><a class="docs-heading-anchor" href="#DataSources">DataSources</a><a id="DataSources-1"></a><a class="docs-heading-anchor-permalink" href="#DataSources" title="Permalink"></a></h2><p>CIF dictionaries can be used with any <code>DataSource</code>, providing that that datasource recognises the data names defined in the dictionary.</p><p>A <code>DataSource</code> is any data source returning an array of values when supplied with a string.  A CIF <code>Block</code> conforms to this specification.  <code>DataSource</code>s are defined in submodule <code>CrystalInfoFramework.DataContainer</code>.</p><p>A CIF dictionary can be used to obtain data with correct Julia type from a <code>DataSource</code> that uses data names defined in the dictionary by  creating a <code>TypedDataSource</code>:</p><pre><code class="language-julia">julia&gt; using CrystalInfoFramework.DataContainer
julia&gt; my_dict = DDLm_Dictionary(&quot;cif_core.dic&quot;)
julia&gt; bd = TypedDataSource(my_block,my_dict)
julia&gt; l = bd[&quot;_cell.length_a&quot;]
1-element Array{Float64,1}:
 11.52
julia&gt; l = bd[&quot;_cell_length_a&quot;] #understand aliases
1-element Array{Float64,1}:
 11.52</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API Documentation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 8 December 2020 06:44">Tuesday 8 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
